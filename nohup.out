[2025-11-09 12:29:39] [INFO] - [Main] /home/miyata/LoRA_Kuroki/DualB-FedLoRA/resnet/../config.yml から設定をロードしました。
[2025-11-09 12:29:39] [INFO] - Loaded config:
{
  "experiment_name": "01",
  "num_clients": 5,
  "num_rounds": 20,
  "local_epochs": 2,
  "non_iid_alpha": 0.3,
  "eval_interval": 1,
  "rank": 4,
  "image_size": 64,
  "lora_target_modules": [
    "mlp",
    "head"
  ],
  "client_lr": 0.01,
  "server_lr": 0.1,
  "spsa_eta_b": 0.0001,
  "spsa_epsilon": 0.1,
  "server_momentum": 0.9,
  "shapley_tmc_iterations": 20,
  "proxy_validation_type": "g_A"
}
[2025-11-09 12:29:39] [INFO] - 
[Main] Using device: cuda
[2025-11-09 12:29:39] [INFO] - 
[Main] 共通データセットを準備します...
[2025-11-09 12:29:39] [INFO] - [Main] 入力解像度を 64x64 に設定します。
[2025-11-09 12:29:40] [INFO] - [Data] Non-IIDデータ分割を開始 (Alpha=0.3)...
[2025-11-09 12:29:40] [INFO] - [Data] 5 クライアント分のデータローダーを作成完了。
[2025-11-09 12:29:40] [INFO] - [Main] テストローダーのバッチサイズ: 64
[2025-11-09 12:29:40] [INFO] - --- [パート1] B-Fixed (ResNet) 版 ---
[2025-11-09 12:29:40] [INFO] - Clients: 5, Rounds: 20, Rank: 4
[2025-11-09 12:29:40] [INFO] - ------------------------------
[2025-11-09 12:29:40] [INFO] - [Model] ResNet-50 (ImageNet-1k) をロード中...
[2025-11-09 12:29:40] [INFO] - [Model] ResNet-50ロード完了。分類ヘッド (Linear 2048->10) をLoRA化 (Rank=4)。
[2025-11-09 12:29:41] [INFO] - [Server] B_server を直交行列 (shape 10x4) で初期化しました。
[2025-11-09 12:29:41] [INFO] - [Server] B-Fixed (ResNet) サーバを初期化しました。
[2025-11-09 12:29:41] [INFO] - [Main] Client LR: 0.01
[2025-11-09 12:29:41] [INFO] - [Main] 5 クライアントの初期化完了。
[2025-11-09 12:29:41] [INFO] - ------------------------------
[2025-11-09 12:29:41] [INFO] - [Main] グローバルテスト精度を 1 ラウンドごとに計算します。
[2025-11-09 12:29:41] [INFO] - 
--- Round 1/20 ---
[2025-11-09 12:29:52] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.3768
[2025-11-09 12:30:04] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.1185
[2025-11-09 12:30:19] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.4516
[2025-11-09 12:30:34] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.3891
[2025-11-09 12:30:45] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1961
[2025-11-09 12:30:45] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:30:45] [INFO] - 
[Main] Round 1: グローバルテスト精度を計算中...
[2025-11-09 12:30:48] [INFO] - ====== [Main] Round 1 Global Test Accuracy: 44.0500% ======
[2025-11-09 12:30:48] [INFO] - 
--- Round 2/20 ---
[2025-11-09 12:30:59] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1043
[2025-11-09 12:31:10] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8153
[2025-11-09 12:31:25] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.2141
[2025-11-09 12:31:40] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1771
[2025-11-09 12:31:52] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.9817
[2025-11-09 12:31:52] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:31:52] [INFO] - 
[Main] Round 2: グローバルテスト精度を計算中...
[2025-11-09 12:31:54] [INFO] - ====== [Main] Round 2 Global Test Accuracy: 46.7900% ======
[2025-11-09 12:31:54] [INFO] - 
--- Round 3/20 ---
[2025-11-09 12:32:06] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0331
[2025-11-09 12:32:17] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.7448
[2025-11-09 12:32:32] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.1361
[2025-11-09 12:32:47] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1159
[2025-11-09 12:32:59] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.9170
[2025-11-09 12:32:59] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:32:59] [INFO] - 
[Main] Round 3: グローバルテスト精度を計算中...
[2025-11-09 12:33:01] [INFO] - ====== [Main] Round 3 Global Test Accuracy: 48.1500% ======
[2025-11-09 12:33:01] [INFO] - 
--- Round 4/20 ---
[2025-11-09 12:33:12] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9842
[2025-11-09 12:33:23] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6966
[2025-11-09 12:33:39] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.0859
[2025-11-09 12:33:53] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0787
[2025-11-09 12:34:06] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.8770
[2025-11-09 12:34:06] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:34:06] [INFO] - 
[Main] Round 4: グローバルテスト精度を計算中...
[2025-11-09 12:34:08] [INFO] - ====== [Main] Round 4 Global Test Accuracy: 49.1100% ======
[2025-11-09 12:34:08] [INFO] - 
--- Round 5/20 ---
[2025-11-09 12:34:19] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9439
[2025-11-09 12:34:31] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6644
[2025-11-09 12:34:48] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.0582
[2025-11-09 12:35:04] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0530
[2025-11-09 12:35:17] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.8552
[2025-11-09 12:35:17] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:35:17] [INFO] - 
[Main] Round 5: グローバルテスト精度を計算中...
[2025-11-09 12:35:19] [INFO] - ====== [Main] Round 5 Global Test Accuracy: 49.6200% ======
[2025-11-09 12:35:19] [INFO] - 
--- Round 6/20 ---
[2025-11-09 12:35:30] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9201
[2025-11-09 12:35:43] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6505
[2025-11-09 12:35:58] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.0441
[2025-11-09 12:36:14] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0353
[2025-11-09 12:36:26] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.8280
[2025-11-09 12:36:26] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:36:26] [INFO] - 
[Main] Round 6: グローバルテスト精度を計算中...
[2025-11-09 12:36:28] [INFO] - ====== [Main] Round 6 Global Test Accuracy: 50.1100% ======
[2025-11-09 12:36:28] [INFO] - 
--- Round 7/20 ---
[2025-11-09 12:36:40] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8975
[2025-11-09 12:36:52] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6232
[2025-11-09 12:37:08] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.0215
[2025-11-09 12:37:24] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0208
[2025-11-09 12:37:35] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.8116
[2025-11-09 12:37:35] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:37:35] [INFO] - 
[Main] Round 7: グローバルテスト精度を計算中...
[2025-11-09 12:37:38] [INFO] - ====== [Main] Round 7 Global Test Accuracy: 50.4600% ======
[2025-11-09 12:37:38] [INFO] - 
--- Round 8/20 ---
[2025-11-09 12:37:49] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8774
[2025-11-09 12:38:01] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6128
[2025-11-09 12:38:15] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.0091
[2025-11-09 12:38:30] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0170
[2025-11-09 12:38:42] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7963
[2025-11-09 12:38:42] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:38:42] [INFO] - 
[Main] Round 8: グローバルテスト精度を計算中...
[2025-11-09 12:38:44] [INFO] - ====== [Main] Round 8 Global Test Accuracy: 50.6000% ======
[2025-11-09 12:38:44] [INFO] - 
--- Round 9/20 ---
[2025-11-09 12:38:55] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8605
[2025-11-09 12:39:06] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.6004
[2025-11-09 12:39:22] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9973
[2025-11-09 12:39:36] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9971
[2025-11-09 12:39:48] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7912
[2025-11-09 12:39:48] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:39:48] [INFO] - 
[Main] Round 9: グローバルテスト精度を計算中...
[2025-11-09 12:39:50] [INFO] - ====== [Main] Round 9 Global Test Accuracy: 50.8800% ======
[2025-11-09 12:39:50] [INFO] - 
--- Round 10/20 ---
[2025-11-09 12:40:02] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8630
[2025-11-09 12:40:14] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5822
[2025-11-09 12:40:30] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9834
[2025-11-09 12:40:44] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9866
[2025-11-09 12:40:57] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7882
[2025-11-09 12:40:57] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:40:57] [INFO] - 
[Main] Round 10: グローバルテスト精度を計算中...
[2025-11-09 12:40:59] [INFO] - ====== [Main] Round 10 Global Test Accuracy: 51.0100% ======
[2025-11-09 12:40:59] [INFO] - 
--- Round 11/20 ---
[2025-11-09 12:41:11] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8437
[2025-11-09 12:41:22] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5885
[2025-11-09 12:41:38] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9768
[2025-11-09 12:41:52] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9798
[2025-11-09 12:42:04] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7767
[2025-11-09 12:42:04] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:42:04] [INFO] - 
[Main] Round 11: グローバルテスト精度を計算中...
[2025-11-09 12:42:07] [INFO] - ====== [Main] Round 11 Global Test Accuracy: 51.2800% ======
[2025-11-09 12:42:07] [INFO] - 
--- Round 12/20 ---
[2025-11-09 12:42:17] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8373
[2025-11-09 12:42:29] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5722
[2025-11-09 12:42:45] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9728
[2025-11-09 12:42:59] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9782
[2025-11-09 12:43:11] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7695
[2025-11-09 12:43:11] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:43:11] [INFO] - 
[Main] Round 12: グローバルテスト精度を計算中...
[2025-11-09 12:43:14] [INFO] - ====== [Main] Round 12 Global Test Accuracy: 51.1400% ======
[2025-11-09 12:43:14] [INFO] - 
--- Round 13/20 ---
[2025-11-09 12:43:24] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8250
[2025-11-09 12:43:36] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5699
[2025-11-09 12:43:50] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9604
[2025-11-09 12:44:05] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9723
[2025-11-09 12:44:17] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7596
[2025-11-09 12:44:17] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:44:17] [INFO] - 
[Main] Round 13: グローバルテスト精度を計算中...
[2025-11-09 12:44:20] [INFO] - ====== [Main] Round 13 Global Test Accuracy: 51.2000% ======
[2025-11-09 12:44:20] [INFO] - 
--- Round 14/20 ---
[2025-11-09 12:44:30] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8210
[2025-11-09 12:44:42] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5591
[2025-11-09 12:44:57] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9578
[2025-11-09 12:45:12] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9649
[2025-11-09 12:45:25] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7584
[2025-11-09 12:45:25] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:45:25] [INFO] - 
[Main] Round 14: グローバルテスト精度を計算中...
[2025-11-09 12:45:27] [INFO] - ====== [Main] Round 14 Global Test Accuracy: 51.3100% ======
[2025-11-09 12:45:27] [INFO] - 
--- Round 15/20 ---
[2025-11-09 12:45:37] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8082
[2025-11-09 12:45:49] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5482
[2025-11-09 12:46:03] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9423
[2025-11-09 12:46:18] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9573
[2025-11-09 12:46:30] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7537
[2025-11-09 12:46:30] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:46:30] [INFO] - 
[Main] Round 15: グローバルテスト精度を計算中...
[2025-11-09 12:46:32] [INFO] - ====== [Main] Round 15 Global Test Accuracy: 51.2800% ======
[2025-11-09 12:46:32] [INFO] - 
--- Round 16/20 ---
[2025-11-09 12:46:42] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8058
[2025-11-09 12:46:54] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5357
[2025-11-09 12:47:09] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9413
[2025-11-09 12:47:24] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9494
[2025-11-09 12:47:36] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7473
[2025-11-09 12:47:36] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:47:36] [INFO] - 
[Main] Round 16: グローバルテスト精度を計算中...
[2025-11-09 12:47:39] [INFO] - ====== [Main] Round 16 Global Test Accuracy: 51.2300% ======
[2025-11-09 12:47:39] [INFO] - 
--- Round 17/20 ---
[2025-11-09 12:47:50] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.7955
[2025-11-09 12:48:02] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5350
[2025-11-09 12:48:17] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9421
[2025-11-09 12:48:32] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9491
[2025-11-09 12:48:44] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7494
[2025-11-09 12:48:44] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:48:44] [INFO] - 
[Main] Round 17: グローバルテスト精度を計算中...
[2025-11-09 12:48:47] [INFO] - ====== [Main] Round 17 Global Test Accuracy: 51.4300% ======
[2025-11-09 12:48:47] [INFO] - 
--- Round 18/20 ---
[2025-11-09 12:48:58] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.8046
[2025-11-09 12:49:09] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5305
[2025-11-09 12:49:25] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9305
[2025-11-09 12:49:40] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9462
[2025-11-09 12:49:52] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7339
[2025-11-09 12:49:52] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:49:52] [INFO] - 
[Main] Round 18: グローバルテスト精度を計算中...
[2025-11-09 12:49:54] [INFO] - ====== [Main] Round 18 Global Test Accuracy: 51.4300% ======
[2025-11-09 12:49:54] [INFO] - 
--- Round 19/20 ---
[2025-11-09 12:50:05] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.7904
[2025-11-09 12:50:17] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5317
[2025-11-09 12:50:32] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9269
[2025-11-09 12:50:47] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9416
[2025-11-09 12:50:59] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7367
[2025-11-09 12:50:59] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:50:59] [INFO] - 
[Main] Round 19: グローバルテスト精度を計算中...
[2025-11-09 12:51:02] [INFO] - ====== [Main] Round 19 Global Test Accuracy: 51.3200% ======
[2025-11-09 12:51:02] [INFO] - 
--- Round 20/20 ---
[2025-11-09 12:51:13] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.7878
[2025-11-09 12:51:24] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.5180
[2025-11-09 12:51:41] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.9221
[2025-11-09 12:51:55] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.9405
[2025-11-09 12:52:07] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 0.7275
[2025-11-09 12:52:07] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 12:52:07] [INFO] - 
[Server] Shapley値 (TMC) の計算を開始...
[2025-11-09 12:52:07] [INFO] -            [Shapley] TMC-Shapley (T=20) 開始...
[2025-11-09 12:52:10] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:52:12] [INFO] -            [Shapley] V(S=[1, 4]) = 45.2300%
[2025-11-09 12:52:15] [INFO] -            [Shapley] V(S=[1, 3, 4]) = 43.9500%
[2025-11-09 12:52:17] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:52:19] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:52:21] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:52:24] [INFO] -            [Shapley] V(S=[3, 4]) = 40.0200%
[2025-11-09 12:52:26] [INFO] -            [Shapley] V(S=[2, 3, 4]) = 49.0400%
[2025-11-09 12:52:29] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:52:31] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:52:33] [INFO] -            [Shapley] V(S=[0]) = 50.7500%
[2025-11-09 12:52:36] [INFO] -            [Shapley] V(S=[0, 1]) = 46.9900%
[2025-11-09 12:52:38] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 53.9400%
[2025-11-09 12:52:41] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:52:43] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:52:46] [INFO] -            [Shapley] V(S=[0]) = 50.7500%
[2025-11-09 12:52:48] [INFO] -            [Shapley] V(S=[0, 1]) = 46.9900%
[2025-11-09 12:52:50] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 53.9400%
[2025-11-09 12:52:52] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:52:55] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:52:57] [INFO] -            [Shapley] V(S=[3]) = 35.7300%
[2025-11-09 12:53:00] [INFO] -            [Shapley] V(S=[0, 3]) = 50.3300%
[2025-11-09 12:53:03] [INFO] -            [Shapley] V(S=[0, 2, 3]) = 46.0400%
[2025-11-09 12:53:05] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 49.1900%
[2025-11-09 12:53:08] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:53:11] [INFO] -            [Shapley] V(S=[3]) = 35.7300%
[2025-11-09 12:53:14] [INFO] -            [Shapley] V(S=[3, 4]) = 40.0200%
[2025-11-09 12:53:17] [INFO] -            [Shapley] V(S=[2, 3, 4]) = 49.0400%
[2025-11-09 12:53:21] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 50.0200%
[2025-11-09 12:53:23] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:53:25] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:53:28] [INFO] -            [Shapley] V(S=[0, 4]) = 45.1200%
[2025-11-09 12:53:30] [INFO] -            [Shapley] V(S=[0, 3, 4]) = 49.8400%
[2025-11-09 12:53:33] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:53:35] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:53:37] [INFO] -            [Shapley] V(S=[3]) = 35.7300%
[2025-11-09 12:53:40] [INFO] -            [Shapley] V(S=[0, 3]) = 50.3300%
[2025-11-09 12:53:42] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 53.9400%
[2025-11-09 12:53:45] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:53:47] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:53:50] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:53:53] [INFO] -            [Shapley] V(S=[1, 4]) = 45.2300%
[2025-11-09 12:53:55] [INFO] -            [Shapley] V(S=[1, 3, 4]) = 43.9500%
[2025-11-09 12:53:57] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:54:00] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:54:02] [INFO] -            [Shapley] V(S=[0]) = 50.7500%
[2025-11-09 12:54:04] [INFO] -            [Shapley] V(S=[0, 1]) = 46.9900%
[2025-11-09 12:54:07] [INFO] -            [Shapley] V(S=[0, 1, 4]) = 51.3000%
[2025-11-09 12:54:09] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:54:12] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:54:14] [INFO] -            [Shapley] V(S=[0]) = 50.7500%
[2025-11-09 12:54:17] [INFO] -            [Shapley] V(S=[0, 1]) = 46.9900%
[2025-11-09 12:54:19] [INFO] -            [Shapley] V(S=[0, 1, 2]) = 49.6700%
[2025-11-09 12:54:22] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 49.1900%
[2025-11-09 12:54:24] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:54:26] [INFO] -            [Shapley] V(S=[2]) = 44.6100%
[2025-11-09 12:54:28] [INFO] -            [Shapley] V(S=[1, 2]) = 45.4100%
[2025-11-09 12:54:31] [INFO] -            [Shapley] V(S=[1, 2, 4]) = 49.5700%
[2025-11-09 12:54:33] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:54:35] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:54:38] [INFO] -            [Shapley] V(S=[1]) = 43.7500%
[2025-11-09 12:54:40] [INFO] -            [Shapley] V(S=[1, 4]) = 45.2300%
[2025-11-09 12:54:43] [INFO] -            [Shapley] V(S=[1, 2, 4]) = 49.5700%
[2025-11-09 12:54:45] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 50.2900%
[2025-11-09 12:54:47] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:54:50] [INFO] -            [Shapley] V(S=[0]) = 50.7500%
[2025-11-09 12:54:52] [INFO] -            [Shapley] V(S=[0, 1]) = 46.9900%
[2025-11-09 12:54:55] [INFO] -            [Shapley] V(S=[0, 1, 2]) = 49.6700%
[2025-11-09 12:54:57] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 50.2900%
[2025-11-09 12:54:59] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:55:02] [INFO] -            [Shapley] V(S=[3]) = 35.7300%
[2025-11-09 12:55:04] [INFO] -            [Shapley] V(S=[1, 3]) = 48.9800%
[2025-11-09 12:55:07] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 53.9400%
[2025-11-09 12:55:09] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 51.6700%
[2025-11-09 12:55:11] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:55:14] [INFO] -            [Shapley] V(S=[2]) = 44.6100%
[2025-11-09 12:55:16] [INFO] -            [Shapley] V(S=[2, 4]) = 45.7700%
[2025-11-09 12:55:19] [INFO] -            [Shapley] V(S=[2, 3, 4]) = 49.0400%
[2025-11-09 12:55:21] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 50.0200%
[2025-11-09 12:55:24] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:55:26] [INFO] -            [Shapley] V(S=[1]) = 43.7500%
[2025-11-09 12:55:28] [INFO] -            [Shapley] V(S=[1, 2]) = 45.4100%
[2025-11-09 12:55:30] [INFO] -            [Shapley] V(S=[1, 2, 3]) = 47.3300%
[2025-11-09 12:55:33] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:55:35] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:55:37] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:55:40] [INFO] -            [Shapley] V(S=[2, 4]) = 45.7700%
[2025-11-09 12:55:42] [INFO] -            [Shapley] V(S=[1, 2, 4]) = 49.5700%
[2025-11-09 12:55:45] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:55:47] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:55:50] [INFO] -            [Shapley] V(S=[1]) = 43.7500%
[2025-11-09 12:55:52] [INFO] -            [Shapley] V(S=[1, 4]) = 45.2300%
[2025-11-09 12:55:55] [INFO] -            [Shapley] V(S=[1, 3, 4]) = 43.9500%
[2025-11-09 12:55:57] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 50.6500%
[2025-11-09 12:55:59] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:56:02] [INFO] -            [Shapley] V(S=[4]) = 31.8100%
[2025-11-09 12:56:04] [INFO] -            [Shapley] V(S=[1, 4]) = 45.2300%
[2025-11-09 12:56:07] [INFO] -            [Shapley] V(S=[0, 1, 4]) = 51.3000%
[2025-11-09 12:56:09] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 50.2900%
[2025-11-09 12:56:11] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 51.4900%
[2025-11-09 12:56:11] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-09 12:56:11] [INFO] -          Client 0: phi = 15.7925
[2025-11-09 12:56:11] [INFO] -          Client 1: phi = 9.1850
[2025-11-09 12:56:11] [INFO] -          Client 2: phi = 7.3150
[2025-11-09 12:56:11] [INFO] -          Client 3: phi = 8.8375
[2025-11-09 12:56:11] [INFO] -          Client 4: phi = 10.3600
[2025-11-09 12:56:11] [INFO] - 
[Server] (検証1) Gradient-based Proxy Validation を開始...
[2025-11-09 12:56:11] [INFO] - [Proxy Validation] 各クライアントの勾配貢献度 (C_i) を計算:
[2025-11-09 12:56:11] [INFO] -          Client 0: C_i = 1.6674e+00
[2025-11-09 12:56:11] [INFO] -          Client 1: C_i = 4.0556e-01
[2025-11-09 12:56:11] [INFO] -          Client 2: C_i = 1.4882e+00
[2025-11-09 12:56:11] [INFO] -          Client 3: C_i = 2.5403e-01
[2025-11-09 12:56:11] [INFO] -          Client 4: C_i = 3.8126e-01
[2025-11-09 12:56:11] [INFO] - 
========================================
[2025-11-09 12:56:11] [INFO] - --- (検証1) Gradient-based Proxy 検証結果 ---
[2025-11-09 12:56:11] [INFO] - ========================================
[2025-11-09 12:56:11] [INFO] - Client ID  | Phi (Shapley値)    | C_i (Proxyスコア)   
[2025-11-09 12:56:11] [INFO] - ------------------------------------------------
[2025-11-09 12:56:11] [INFO] - 0          | 15.7925           | 1.6674e+00       
[2025-11-09 12:56:11] [INFO] - 1          | 9.1850            | 4.0556e-01       
[2025-11-09 12:56:11] [INFO] - 2          | 7.3150            | 1.4882e+00       
[2025-11-09 12:56:11] [INFO] - 3          | 8.8375            | 2.5403e-01       
[2025-11-09 12:56:11] [INFO] - 4          | 10.3600           | 3.8126e-01       
[2025-11-09 12:56:11] [INFO] - ------------------------------------------------
[2025-11-09 12:56:11] [INFO] - 
[相関分析結果 (Proxy vs Phi)]
[2025-11-09 12:56:11] [INFO] - スピアマン相関係数 (rho) : 0.3000 (p-value: 0.6238)
[2025-11-09 12:56:11] [INFO] - 
[結論] 相関が低いか負です。
[2025-11-09 12:56:11] [INFO] - 
[Server] (検証2) Local Accuracy vs Shapley Validation を開始...
[2025-11-09 12:56:11] [INFO] - [LocalAcc Validation] 各クライアントの個別テスト精度 (Local Acc) を計算:
[2025-11-09 12:56:15] [INFO] -            [LocalAcc Eval] Client 0 (A_i only) Test Acc = 50.7500%
[2025-11-09 12:56:18] [INFO] -            [LocalAcc Eval] Client 1 (A_i only) Test Acc = 43.7500%
[2025-11-09 12:56:21] [INFO] -            [LocalAcc Eval] Client 2 (A_i only) Test Acc = 44.6100%
[2025-11-09 12:56:23] [INFO] -            [LocalAcc Eval] Client 3 (A_i only) Test Acc = 35.7300%
[2025-11-09 12:56:25] [INFO] -            [LocalAcc Eval] Client 4 (A_i only) Test Acc = 31.8100%
[2025-11-09 12:56:25] [INFO] - 
========================================
[2025-11-09 12:56:25] [INFO] - --- (検証2) Local Accuracy vs Shapley 検証結果 ---
[2025-11-09 12:56:25] [INFO] - ========================================
[2025-11-09 12:56:25] [INFO] - Client ID  | Phi (Shapley値)    | Local Acc (個別精度) 
[2025-11-09 12:56:25] [INFO] - --------------------------------------------------
[2025-11-09 12:56:25] [INFO] - 0          | 15.7925           | 50.7500          %
[2025-11-09 12:56:25] [INFO] - 1          | 9.1850            | 43.7500          %
[2025-11-09 12:56:25] [INFO] - 2          | 7.3150            | 44.6100          %
[2025-11-09 12:56:25] [INFO] - 3          | 8.8375            | 35.7300          %
[2025-11-09 12:56:25] [INFO] - 4          | 10.3600           | 31.8100          %
[2025-11-09 12:56:25] [INFO] - --------------------------------------------------
[2025-11-09 12:56:25] [INFO] - 
[相関分析結果 (Local Acc vs Phi)]
[2025-11-09 12:56:25] [INFO] - スピアマン相関係数 (rho) : 0.1000 (p-value: 0.8729)
[2025-11-09 12:56:25] [INFO] - 
[結論] 正の相関が見られます。
[2025-11-09 12:56:25] [INFO] - 
[Main] Round 20: グローバルテスト精度を計算中...
[2025-11-09 12:56:28] [INFO] - ====== [Main] Round 20 Global Test Accuracy: 51.4900% ======
[2025-11-09 12:56:28] [INFO] - ------------------------------
[2025-11-09 12:56:28] [INFO] - --- [パート1] 学習完了 --- (総所要時間: 1606.99 秒)
[2025-11-09 12:56:28] [INFO] - 
[Main] すべての処理が完了しました。
