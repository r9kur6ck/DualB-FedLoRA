[2025-11-08 18:46:24] [INFO] - [Main] config.yml から設定をロードしました。
[2025-11-08 18:46:24] [INFO] - Loaded config:
{
  "num_clients": 5,
  "num_rounds": 20,
  "local_epochs": 2,
  "non_iid_alpha": 0.3,
  "rank": 4,
  "spsa_epsilon": 0.1,
  "spsa_eta_b": 0.0001,
  "server_momentum": 0.9,
  "shapley_tmc_iterations": 20,
  "eval_interval": 1
}
[2025-11-08 18:46:24] [INFO] - 
[Main] Using device: cuda
[2025-11-08 18:46:24] [INFO] - 
[Main] 共通データセットを準備します...
[2025-11-08 18:46:26] [INFO] - [Data] Non-IIDデータ分割を開始 (Alpha=0.3)...
[2025-11-08 18:46:26] [INFO] - [Data] 5 クライアント分のデータローダーを作成完了。
[2025-11-08 18:46:26] [INFO] - --- [パート1] Shapley-Weighted SPSA 版 ---
[2025-11-08 18:46:26] [INFO] - Clients: 5, Rounds: 20, Rank: 4
[2025-11-08 18:46:26] [INFO] - ------------------------------
[2025-11-08 18:46:26] [INFO] - [Server] Shapley-Weighted SPSA サーバを初期化しました (Momentum=0.9)。
[2025-11-08 18:46:26] [INFO] - [Main] 5 クライアントの初期化完了。
[2025-11-08 18:46:26] [INFO] - ------------------------------
[2025-11-08 18:46:26] [INFO] - [Main] グローバルテスト精度を 1 ラウンドごとに計算します。
[2025-11-08 18:46:26] [INFO] - 
--- Round 1/20 ---
[2025-11-08 18:46:32] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.4376
[2025-11-08 18:46:34] [INFO] -   [Client 0] Evaluate Reward: R_i = 49.81% (5513/11068)
[2025-11-08 18:46:38] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.4432
[2025-11-08 18:46:39] [INFO] -   [Client 1] Evaluate Reward: R_i = 54.08% (4066/7518)
[2025-11-08 18:46:45] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.7155
[2025-11-08 18:46:47] [INFO] -   [Client 2] Evaluate Reward: R_i = 50.52% (6511/12889)
[2025-11-08 18:46:52] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.6397
[2025-11-08 18:46:54] [INFO] -   [Client 3] Evaluate Reward: R_i = 57.12% (5520/9664)
[2025-11-08 18:46:58] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.9645
[2025-11-08 18:47:00] [INFO] -   [Client 4] Evaluate Reward: R_i = 33.97% (3010/8861)
[2025-11-08 18:47:00] [INFO] -          [Server] SW-SPSA Update: R+(w)=45.54, R-(w)=51.47, GradFactor=-29.6289
[2025-11-08 18:47:00] [INFO] -          [Server] (Round 1) 次ラウンド用のShapley重みを計算中...
[2025-11-08 18:49:08] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 18:49:08] [INFO] -          Client 0: phi = 6.0485
[2025-11-08 18:49:08] [INFO] -          Client 1: phi = 2.9470
[2025-11-08 18:49:08] [INFO] -          Client 2: phi = 2.1820
[2025-11-08 18:49:08] [INFO] -          Client 3: phi = 4.8540
[2025-11-08 18:49:08] [INFO] -          Client 4: phi = 1.9185
[2025-11-08 18:49:08] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.337, 0.164, 0.122, 0.27, 0.107]
[2025-11-08 18:49:08] [INFO] -          [Server] Round 1 Avg Reward (All Clients): 49.10%
[2025-11-08 18:49:08] [INFO] - 
[Main] Round 1: グローバルテスト精度を計算中...
[2025-11-08 18:49:09] [INFO] - ====== [Main] Round 1 Global Test Accuracy: 17.9500% ======
[2025-11-08 18:49:09] [INFO] - 
--- Round 2/20 ---
[2025-11-08 18:49:14] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.2401
[2025-11-08 18:49:16] [INFO] -   [Client 0] Evaluate Reward: R_i = 61.42% (6798/11068)
[2025-11-08 18:49:20] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.7417
[2025-11-08 18:49:21] [INFO] -   [Client 1] Evaluate Reward: R_i = 54.38% (4088/7518)
[2025-11-08 18:49:27] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.7621
[2025-11-08 18:49:30] [INFO] -   [Client 2] Evaluate Reward: R_i = 27.25% (3512/12889)
[2025-11-08 18:49:34] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.5395
[2025-11-08 18:49:36] [INFO] -   [Client 3] Evaluate Reward: R_i = 54.90% (5306/9664)
[2025-11-08 18:49:40] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.8939
[2025-11-08 18:49:42] [INFO] -   [Client 4] Evaluate Reward: R_i = 33.65% (2982/8861)
[2025-11-08 18:49:42] [INFO] -          [Server] SW-SPSA Update: R+(w)=59.11, R-(w)=43.61, GradFactor=77.5013
[2025-11-08 18:49:42] [INFO] -          [Server] (Round 2) 次ラウンド用のShapley重みを計算中...
[2025-11-08 18:51:50] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 18:51:50] [INFO] -          Client 0: phi = 5.7335
[2025-11-08 18:51:50] [INFO] -          Client 1: phi = 5.5645
[2025-11-08 18:51:50] [INFO] -          Client 2: phi = 3.9930
[2025-11-08 18:51:50] [INFO] -          Client 3: phi = 4.7945
[2025-11-08 18:51:50] [INFO] -          Client 4: phi = 1.8945
[2025-11-08 18:51:50] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.261, 0.253, 0.182, 0.218, 0.086]
[2025-11-08 18:51:50] [INFO] -          [Server] Round 2 Avg Reward (All Clients): 46.32%
[2025-11-08 18:51:50] [INFO] - 
[Main] Round 2: グローバルテスト精度を計算中...
[2025-11-08 18:51:51] [INFO] - ====== [Main] Round 2 Global Test Accuracy: 21.9800% ======
[2025-11-08 18:51:51] [INFO] - 
--- Round 3/20 ---
[2025-11-08 18:51:56] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.4020
[2025-11-08 18:51:59] [INFO] -   [Client 0] Evaluate Reward: R_i = 55.61% (6155/11068)
[2025-11-08 18:52:02] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.2390
[2025-11-08 18:52:04] [INFO] -   [Client 1] Evaluate Reward: R_i = 56.00% (4210/7518)
[2025-11-08 18:52:10] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.7172
[2025-11-08 18:52:12] [INFO] -   [Client 2] Evaluate Reward: R_i = 40.72% (5249/12889)
[2025-11-08 18:52:17] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.2621
[2025-11-08 18:52:19] [INFO] -   [Client 3] Evaluate Reward: R_i = 64.00% (6185/9664)
[2025-11-08 18:52:23] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.9028
[2025-11-08 18:52:25] [INFO] -   [Client 4] Evaluate Reward: R_i = 33.74% (2990/8861)
[2025-11-08 18:52:25] [INFO] -          [Server] SW-SPSA Update: R+(w)=49.62, R-(w)=55.51, GradFactor=-29.4817
[2025-11-08 18:52:25] [INFO] -          [Server] (Round 3) 次ラウンド用のShapley重みを計算中...
[2025-11-08 18:54:34] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 18:54:34] [INFO] -          Client 0: phi = 2.1410
[2025-11-08 18:54:34] [INFO] -          Client 1: phi = -0.5575
[2025-11-08 18:54:34] [INFO] -          Client 2: phi = 7.9655
[2025-11-08 18:54:34] [INFO] -          Client 3: phi = 4.6160
[2025-11-08 18:54:34] [INFO] -          Client 4: phi = 4.0250
[2025-11-08 18:54:34] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.114, 0.0, 0.425, 0.246, 0.215]
[2025-11-08 18:54:34] [INFO] -          [Server] Round 3 Avg Reward (All Clients): 50.02%
[2025-11-08 18:54:34] [INFO] - 
[Main] Round 3: グローバルテスト精度を計算中...
[2025-11-08 18:54:35] [INFO] - ====== [Main] Round 3 Global Test Accuracy: 18.1900% ======
[2025-11-08 18:54:35] [INFO] - 
--- Round 4/20 ---
[2025-11-08 18:54:40] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.2621
[2025-11-08 18:54:43] [INFO] -   [Client 0] Evaluate Reward: R_i = 53.30% (5899/11068)
[2025-11-08 18:54:46] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.6303
[2025-11-08 18:54:48] [INFO] -   [Client 1] Evaluate Reward: R_i = 53.91% (4053/7518)
[2025-11-08 18:54:54] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.8804
[2025-11-08 18:54:56] [INFO] -   [Client 2] Evaluate Reward: R_i = 17.34% (2235/12889)
[2025-11-08 18:55:01] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.2444
[2025-11-08 18:55:03] [INFO] -   [Client 3] Evaluate Reward: R_i = 65.69% (6348/9664)
[2025-11-08 18:55:07] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.8309
[2025-11-08 18:55:09] [INFO] -   [Client 4] Evaluate Reward: R_i = 37.03% (3281/8861)
[2025-11-08 18:55:09] [INFO] -          [Server] SW-SPSA Update: R+(w)=17.34, R-(w)=52.53, GradFactor=-175.9385
[2025-11-08 18:55:09] [INFO] -          [Server] (Round 4) 次ラウンド用のShapley重みを計算中...
[2025-11-08 18:57:17] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 18:57:17] [INFO] -          Client 0: phi = 5.9515
[2025-11-08 18:57:17] [INFO] -          Client 1: phi = 4.4270
[2025-11-08 18:57:17] [INFO] -          Client 2: phi = 2.7305
[2025-11-08 18:57:17] [INFO] -          Client 3: phi = 6.8995
[2025-11-08 18:57:17] [INFO] -          Client 4: phi = 3.9015
[2025-11-08 18:57:17] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.249, 0.185, 0.114, 0.289, 0.163]
[2025-11-08 18:57:17] [INFO] -          [Server] Round 4 Avg Reward (All Clients): 45.45%
[2025-11-08 18:57:17] [INFO] - 
[Main] Round 4: グローバルテスト精度を計算中...
[2025-11-08 18:57:18] [INFO] - ====== [Main] Round 4 Global Test Accuracy: 23.9100% ======
[2025-11-08 18:57:18] [INFO] - 
--- Round 5/20 ---
[2025-11-08 18:57:23] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1339
[2025-11-08 18:57:25] [INFO] -   [Client 0] Evaluate Reward: R_i = 63.72% (7053/11068)
[2025-11-08 18:57:29] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.5172
[2025-11-08 18:57:30] [INFO] -   [Client 1] Evaluate Reward: R_i = 55.35% (4161/7518)
[2025-11-08 18:57:36] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.6328
[2025-11-08 18:57:39] [INFO] -   [Client 2] Evaluate Reward: R_i = 49.43% (6371/12889)
[2025-11-08 18:57:43] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1814
[2025-11-08 18:57:45] [INFO] -   [Client 3] Evaluate Reward: R_i = 67.42% (6515/9664)
[2025-11-08 18:57:49] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.9192
[2025-11-08 18:57:50] [INFO] -   [Client 4] Evaluate Reward: R_i = 32.86% (2912/8861)
[2025-11-08 18:57:50] [INFO] -          [Server] SW-SPSA Update: R+(w)=39.68, R-(w)=63.05, GradFactor=-116.8393
[2025-11-08 18:57:50] [INFO] -          [Server] (Round 5) 次ラウンド用のShapley重みを計算中...
[2025-11-08 18:59:59] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 18:59:59] [INFO] -          Client 0: phi = 5.6570
[2025-11-08 18:59:59] [INFO] -          Client 1: phi = 5.0330
[2025-11-08 18:59:59] [INFO] -          Client 2: phi = -2.1235
[2025-11-08 18:59:59] [INFO] -          Client 3: phi = 6.5090
[2025-11-08 18:59:59] [INFO] -          Client 4: phi = 6.9745
[2025-11-08 18:59:59] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.234, 0.208, 0.0, 0.269, 0.289]
[2025-11-08 18:59:59] [INFO] -          [Server] Round 5 Avg Reward (All Clients): 53.76%
[2025-11-08 18:59:59] [INFO] - 
[Main] Round 5: グローバルテスト精度を計算中...
[2025-11-08 19:00:01] [INFO] - ====== [Main] Round 5 Global Test Accuracy: 22.0500% ======
[2025-11-08 19:00:01] [INFO] - 
--- Round 6/20 ---
[2025-11-08 19:00:06] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1518
[2025-11-08 19:00:08] [INFO] -   [Client 0] Evaluate Reward: R_i = 65.11% (7206/11068)
[2025-11-08 19:00:12] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.6146
[2025-11-08 19:00:13] [INFO] -   [Client 1] Evaluate Reward: R_i = 53.75% (4041/7518)
[2025-11-08 19:00:19] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.6360
[2025-11-08 19:00:21] [INFO] -   [Client 2] Evaluate Reward: R_i = 46.43% (5985/12889)
[2025-11-08 19:00:26] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1638
[2025-11-08 19:00:28] [INFO] -   [Client 3] Evaluate Reward: R_i = 67.69% (6542/9664)
[2025-11-08 19:00:32] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.9062
[2025-11-08 19:00:34] [INFO] -   [Client 4] Evaluate Reward: R_i = 35.89% (3180/8861)
[2025-11-08 19:00:34] [INFO] -          [Server] SW-SPSA Update: R+(w)=53.75, R-(w)=55.34, GradFactor=-7.9436
[2025-11-08 19:00:34] [INFO] -          [Server] (Round 6) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:02:42] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:02:42] [INFO] -          Client 0: phi = 0.8860
[2025-11-08 19:02:42] [INFO] -          Client 1: phi = 2.1685
[2025-11-08 19:02:42] [INFO] -          Client 2: phi = -0.4190
[2025-11-08 19:02:42] [INFO] -          Client 3: phi = 11.4025
[2025-11-08 19:02:42] [INFO] -          Client 4: phi = 8.3720
[2025-11-08 19:02:42] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.039, 0.095, 0.0, 0.499, 0.367]
[2025-11-08 19:02:42] [INFO] -          [Server] Round 6 Avg Reward (All Clients): 53.77%
[2025-11-08 19:02:42] [INFO] - 
[Main] Round 6: グローバルテスト精度を計算中...
[2025-11-08 19:02:44] [INFO] - ====== [Main] Round 6 Global Test Accuracy: 22.4100% ======
[2025-11-08 19:02:44] [INFO] - 
--- Round 7/20 ---
[2025-11-08 19:02:49] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.3517
[2025-11-08 19:02:51] [INFO] -   [Client 0] Evaluate Reward: R_i = 51.57% (5708/11068)
[2025-11-08 19:02:54] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.4638
[2025-11-08 19:02:56] [INFO] -   [Client 1] Evaluate Reward: R_i = 55.60% (4180/7518)
[2025-11-08 19:03:02] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.7300
[2025-11-08 19:03:05] [INFO] -   [Client 2] Evaluate Reward: R_i = 45.26% (5834/12889)
[2025-11-08 19:03:09] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1864
[2025-11-08 19:03:11] [INFO] -   [Client 3] Evaluate Reward: R_i = 67.30% (6504/9664)
[2025-11-08 19:03:15] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.8862
[2025-11-08 19:03:17] [INFO] -   [Client 4] Evaluate Reward: R_i = 34.34% (3043/8861)
[2025-11-08 19:03:17] [INFO] -          [Server] SW-SPSA Update: R+(w)=65.43, R-(w)=35.99, GradFactor=147.2054
[2025-11-08 19:03:17] [INFO] -          [Server] (Round 7) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:05:26] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:05:26] [INFO] -          Client 0: phi = 5.7920
[2025-11-08 19:05:26] [INFO] -          Client 1: phi = 4.4805
[2025-11-08 19:05:26] [INFO] -          Client 2: phi = 4.6605
[2025-11-08 19:05:26] [INFO] -          Client 3: phi = 4.4900
[2025-11-08 19:05:26] [INFO] -          Client 4: phi = 6.7770
[2025-11-08 19:05:26] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.221, 0.171, 0.178, 0.171, 0.259]
[2025-11-08 19:05:26] [INFO] -          [Server] Round 7 Avg Reward (All Clients): 50.82%
[2025-11-08 19:05:26] [INFO] - 
[Main] Round 7: グローバルテスト精度を計算中...
[2025-11-08 19:05:28] [INFO] - ====== [Main] Round 7 Global Test Accuracy: 26.2000% ======
[2025-11-08 19:05:28] [INFO] - 
--- Round 8/20 ---
[2025-11-08 19:05:33] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1251
[2025-11-08 19:05:35] [INFO] -   [Client 0] Evaluate Reward: R_i = 61.49% (6806/11068)
[2025-11-08 19:05:38] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.7349
[2025-11-08 19:05:40] [INFO] -   [Client 1] Evaluate Reward: R_i = 44.25% (3327/7518)
[2025-11-08 19:05:46] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.3461
[2025-11-08 19:05:48] [INFO] -   [Client 2] Evaluate Reward: R_i = 56.78% (7318/12889)
[2025-11-08 19:05:53] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1091
[2025-11-08 19:05:55] [INFO] -   [Client 3] Evaluate Reward: R_i = 66.64% (6440/9664)
[2025-11-08 19:05:58] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.7985
[2025-11-08 19:06:00] [INFO] -   [Client 4] Evaluate Reward: R_i = 37.05% (3283/8861)
[2025-11-08 19:06:00] [INFO] -          [Server] SW-SPSA Update: R+(w)=55.46, R-(w)=50.60, GradFactor=24.2770
[2025-11-08 19:06:00] [INFO] -          [Server] (Round 8) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:08:10] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:08:10] [INFO] -          Client 0: phi = 4.5550
[2025-11-08 19:08:10] [INFO] -          Client 1: phi = 3.9120
[2025-11-08 19:08:10] [INFO] -          Client 2: phi = 4.7275
[2025-11-08 19:08:10] [INFO] -          Client 3: phi = 9.3920
[2025-11-08 19:08:10] [INFO] -          Client 4: phi = 2.5535
[2025-11-08 19:08:10] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.181, 0.156, 0.188, 0.374, 0.102]
[2025-11-08 19:08:10] [INFO] -          [Server] Round 8 Avg Reward (All Clients): 53.24%
[2025-11-08 19:08:10] [INFO] - 
[Main] Round 8: グローバルテスト精度を計算中...
[2025-11-08 19:08:11] [INFO] - ====== [Main] Round 8 Global Test Accuracy: 25.1400% ======
[2025-11-08 19:08:11] [INFO] - 
--- Round 9/20 ---
[2025-11-08 19:08:16] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1226
[2025-11-08 19:08:18] [INFO] -   [Client 0] Evaluate Reward: R_i = 63.06% (6979/11068)
[2025-11-08 19:08:22] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3418
[2025-11-08 19:08:23] [INFO] -   [Client 1] Evaluate Reward: R_i = 56.50% (4248/7518)
[2025-11-08 19:08:29] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.5253
[2025-11-08 19:08:31] [INFO] -   [Client 2] Evaluate Reward: R_i = 53.15% (6851/12889)
[2025-11-08 19:08:36] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1011
[2025-11-08 19:08:38] [INFO] -   [Client 3] Evaluate Reward: R_i = 69.07% (6675/9664)
[2025-11-08 19:08:42] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.7673
[2025-11-08 19:08:44] [INFO] -   [Client 4] Evaluate Reward: R_i = 37.24% (3300/8861)
[2025-11-08 19:08:44] [INFO] -          [Server] SW-SPSA Update: R+(w)=58.01, R-(w)=60.85, GradFactor=-14.1630
[2025-11-08 19:08:44] [INFO] -          [Server] (Round 9) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:10:53] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:10:53] [INFO] -          Client 0: phi = 2.5975
[2025-11-08 19:10:53] [INFO] -          Client 1: phi = -0.1025
[2025-11-08 19:10:53] [INFO] -          Client 2: phi = 5.4070
[2025-11-08 19:10:53] [INFO] -          Client 3: phi = 8.1035
[2025-11-08 19:10:53] [INFO] -          Client 4: phi = 7.8045
[2025-11-08 19:10:53] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.109, 0.0, 0.226, 0.339, 0.326]
[2025-11-08 19:10:53] [INFO] -          [Server] Round 9 Avg Reward (All Clients): 55.81%
[2025-11-08 19:10:53] [INFO] - 
[Main] Round 9: グローバルテスト精度を計算中...
[2025-11-08 19:10:55] [INFO] - ====== [Main] Round 9 Global Test Accuracy: 23.8100% ======
[2025-11-08 19:10:55] [INFO] - 
--- Round 10/20 ---
[2025-11-08 19:11:00] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0964
[2025-11-08 19:11:02] [INFO] -   [Client 0] Evaluate Reward: R_i = 62.20% (6884/11068)
[2025-11-08 19:11:06] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3289
[2025-11-08 19:11:07] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.46% (4320/7518)
[2025-11-08 19:11:13] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.4210
[2025-11-08 19:11:16] [INFO] -   [Client 2] Evaluate Reward: R_i = 45.20% (5826/12889)
[2025-11-08 19:11:20] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1886
[2025-11-08 19:11:22] [INFO] -   [Client 3] Evaluate Reward: R_i = 68.32% (6602/9664)
[2025-11-08 19:11:26] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.7726
[2025-11-08 19:11:28] [INFO] -   [Client 4] Evaluate Reward: R_i = 37.75% (3345/8861)
[2025-11-08 19:11:28] [INFO] -          [Server] SW-SPSA Update: R+(w)=59.06, R-(w)=43.85, GradFactor=76.0522
[2025-11-08 19:11:28] [INFO] -          [Server] (Round 10) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:13:37] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:13:37] [INFO] -          Client 0: phi = 4.8035
[2025-11-08 19:13:37] [INFO] -          Client 1: phi = 3.5280
[2025-11-08 19:13:37] [INFO] -          Client 2: phi = 5.3655
[2025-11-08 19:13:37] [INFO] -          Client 3: phi = 6.9645
[2025-11-08 19:13:37] [INFO] -          Client 4: phi = 4.7885
[2025-11-08 19:13:37] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.189, 0.139, 0.211, 0.274, 0.188]
[2025-11-08 19:13:37] [INFO] -          [Server] Round 10 Avg Reward (All Clients): 54.19%
[2025-11-08 19:13:37] [INFO] - 
[Main] Round 10: グローバルテスト精度を計算中...
[2025-11-08 19:13:39] [INFO] - ====== [Main] Round 10 Global Test Accuracy: 25.4500% ======
[2025-11-08 19:13:39] [INFO] - 
--- Round 11/20 ---
[2025-11-08 19:13:44] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0669
[2025-11-08 19:13:47] [INFO] -   [Client 0] Evaluate Reward: R_i = 66.74% (7387/11068)
[2025-11-08 19:13:51] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.4500
[2025-11-08 19:13:52] [INFO] -   [Client 1] Evaluate Reward: R_i = 55.97% (4208/7518)
[2025-11-08 19:13:59] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.3031
[2025-11-08 19:14:02] [INFO] -   [Client 2] Evaluate Reward: R_i = 57.81% (7451/12889)
[2025-11-08 19:14:07] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1128
[2025-11-08 19:14:09] [INFO] -   [Client 3] Evaluate Reward: R_i = 68.52% (6622/9664)
[2025-11-08 19:14:14] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.7136
[2025-11-08 19:14:16] [INFO] -   [Client 4] Evaluate Reward: R_i = 42.25% (3744/8861)
[2025-11-08 19:14:16] [INFO] -          [Server] SW-SPSA Update: R+(w)=54.52, R-(w)=62.11, GradFactor=-37.9453
[2025-11-08 19:14:16] [INFO] -          [Server] (Round 11) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:16:24] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:16:24] [INFO] -          Client 0: phi = 5.0085
[2025-11-08 19:16:24] [INFO] -          Client 1: phi = 1.8120
[2025-11-08 19:16:24] [INFO] -          Client 2: phi = 3.0925
[2025-11-08 19:16:24] [INFO] -          Client 3: phi = 6.0440
[2025-11-08 19:16:24] [INFO] -          Client 4: phi = 7.6230
[2025-11-08 19:16:24] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.212, 0.077, 0.131, 0.256, 0.323]
[2025-11-08 19:16:24] [INFO] -          [Server] Round 11 Avg Reward (All Clients): 58.26%
[2025-11-08 19:16:24] [INFO] - 
[Main] Round 11: グローバルテスト精度を計算中...
[2025-11-08 19:16:26] [INFO] - ====== [Main] Round 11 Global Test Accuracy: 23.5800% ======
[2025-11-08 19:16:26] [INFO] - 
--- Round 12/20 ---
[2025-11-08 19:16:31] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0436
[2025-11-08 19:16:33] [INFO] -   [Client 0] Evaluate Reward: R_i = 67.90% (7515/11068)
[2025-11-08 19:16:37] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.4506
[2025-11-08 19:16:38] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.10% (4293/7518)
[2025-11-08 19:16:44] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.3575
[2025-11-08 19:16:47] [INFO] -   [Client 2] Evaluate Reward: R_i = 47.46% (6117/12889)
[2025-11-08 19:16:51] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1353
[2025-11-08 19:16:53] [INFO] -   [Client 3] Evaluate Reward: R_i = 68.81% (6650/9664)
[2025-11-08 19:16:57] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.7291
[2025-11-08 19:16:59] [INFO] -   [Client 4] Evaluate Reward: R_i = 39.48% (3498/8861)
[2025-11-08 19:16:59] [INFO] -          [Server] SW-SPSA Update: R+(w)=68.40, R-(w)=44.00, GradFactor=122.0079
[2025-11-08 19:16:59] [INFO] -          [Server] (Round 12) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:19:08] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:19:08] [INFO] -          Client 0: phi = 3.6935
[2025-11-08 19:19:08] [INFO] -          Client 1: phi = -0.6575
[2025-11-08 19:19:08] [INFO] -          Client 2: phi = 8.6565
[2025-11-08 19:19:08] [INFO] -          Client 3: phi = 9.4720
[2025-11-08 19:19:08] [INFO] -          Client 4: phi = 4.1955
[2025-11-08 19:19:08] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.142, 0.0, 0.333, 0.364, 0.161]
[2025-11-08 19:19:08] [INFO] -          [Server] Round 12 Avg Reward (All Clients): 56.15%
[2025-11-08 19:19:08] [INFO] - 
[Main] Round 12: グローバルテスト精度を計算中...
[2025-11-08 19:19:10] [INFO] - ====== [Main] Round 12 Global Test Accuracy: 25.3600% ======
[2025-11-08 19:19:10] [INFO] - 
--- Round 13/20 ---
[2025-11-08 19:19:14] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0579
[2025-11-08 19:19:17] [INFO] -   [Client 0] Evaluate Reward: R_i = 67.82% (7506/11068)
[2025-11-08 19:19:20] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.4481
[2025-11-08 19:19:22] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.66% (4335/7518)
[2025-11-08 19:19:27] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.4786
[2025-11-08 19:19:30] [INFO] -   [Client 2] Evaluate Reward: R_i = 56.27% (7253/12889)
[2025-11-08 19:19:35] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0396
[2025-11-08 19:19:37] [INFO] -   [Client 3] Evaluate Reward: R_i = 69.85% (6750/9664)
[2025-11-08 19:19:41] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6883
[2025-11-08 19:19:43] [INFO] -   [Client 4] Evaluate Reward: R_i = 40.56% (3594/8861)
[2025-11-08 19:19:43] [INFO] -          [Server] SW-SPSA Update: R+(w)=40.56, R-(w)=64.12, GradFactor=-117.7945
[2025-11-08 19:19:43] [INFO] -          [Server] (Round 13) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:21:51] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:21:51] [INFO] -          Client 0: phi = 0.0890
[2025-11-08 19:21:51] [INFO] -          Client 1: phi = 4.7735
[2025-11-08 19:21:51] [INFO] -          Client 2: phi = 4.8345
[2025-11-08 19:21:51] [INFO] -          Client 3: phi = 10.2145
[2025-11-08 19:21:51] [INFO] -          Client 4: phi = 8.6785
[2025-11-08 19:21:51] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.003, 0.167, 0.169, 0.357, 0.304]
[2025-11-08 19:21:51] [INFO] -          [Server] Round 13 Avg Reward (All Clients): 58.43%
[2025-11-08 19:21:51] [INFO] - 
[Main] Round 13: グローバルテスト精度を計算中...
[2025-11-08 19:21:52] [INFO] - ====== [Main] Round 13 Global Test Accuracy: 28.5900% ======
[2025-11-08 19:21:52] [INFO] - 
--- Round 14/20 ---
[2025-11-08 19:21:57] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9981
[2025-11-08 19:21:59] [INFO] -   [Client 0] Evaluate Reward: R_i = 68.00% (7526/11068)
[2025-11-08 19:22:03] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.5589
[2025-11-08 19:22:04] [INFO] -   [Client 1] Evaluate Reward: R_i = 48.78% (3667/7518)
[2025-11-08 19:22:10] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.4440
[2025-11-08 19:22:13] [INFO] -   [Client 2] Evaluate Reward: R_i = 54.79% (7062/12889)
[2025-11-08 19:22:17] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0615
[2025-11-08 19:22:19] [INFO] -   [Client 3] Evaluate Reward: R_i = 70.76% (6838/9664)
[2025-11-08 19:22:23] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6793
[2025-11-08 19:22:25] [INFO] -   [Client 4] Evaluate Reward: R_i = 42.12% (3732/8861)
[2025-11-08 19:22:25] [INFO] -          [Server] SW-SPSA Update: R+(w)=63.76, R-(w)=46.79, GradFactor=84.8282
[2025-11-08 19:22:25] [INFO] -          [Server] (Round 14) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:24:36] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:24:36] [INFO] -          Client 0: phi = 6.4290
[2025-11-08 19:24:36] [INFO] -          Client 1: phi = 6.5845
[2025-11-08 19:24:36] [INFO] -          Client 2: phi = 9.7335
[2025-11-08 19:24:36] [INFO] -          Client 3: phi = 5.7015
[2025-11-08 19:24:36] [INFO] -          Client 4: phi = 3.8115
[2025-11-08 19:24:36] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.199, 0.204, 0.302, 0.177, 0.118]
[2025-11-08 19:24:36] [INFO] -          [Server] Round 14 Avg Reward (All Clients): 56.89%
[2025-11-08 19:24:36] [INFO] - 
[Main] Round 14: グローバルテスト精度を計算中...
[2025-11-08 19:24:37] [INFO] - ====== [Main] Round 14 Global Test Accuracy: 32.2600% ======
[2025-11-08 19:24:37] [INFO] - 
--- Round 15/20 ---
[2025-11-08 19:24:42] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0164
[2025-11-08 19:24:45] [INFO] -   [Client 0] Evaluate Reward: R_i = 68.89% (7625/11068)
[2025-11-08 19:24:49] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.6463
[2025-11-08 19:24:50] [INFO] -   [Client 1] Evaluate Reward: R_i = 47.79% (3593/7518)
[2025-11-08 19:24:57] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.3621
[2025-11-08 19:25:00] [INFO] -   [Client 2] Evaluate Reward: R_i = 50.48% (6506/12889)
[2025-11-08 19:25:05] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1880
[2025-11-08 19:25:07] [INFO] -   [Client 3] Evaluate Reward: R_i = 65.96% (6374/9664)
[2025-11-08 19:25:11] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6414
[2025-11-08 19:25:13] [INFO] -   [Client 4] Evaluate Reward: R_i = 42.51% (3767/8861)
[2025-11-08 19:25:13] [INFO] -          [Server] SW-SPSA Update: R+(w)=56.56, R-(w)=54.90, GradFactor=8.2922
[2025-11-08 19:25:13] [INFO] -          [Server] (Round 15) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:27:22] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:27:22] [INFO] -          Client 0: phi = 1.5960
[2025-11-08 19:27:22] [INFO] -          Client 1: phi = 2.8000
[2025-11-08 19:27:22] [INFO] -          Client 2: phi = 8.1480
[2025-11-08 19:27:22] [INFO] -          Client 3: phi = 9.2675
[2025-11-08 19:27:22] [INFO] -          Client 4: phi = 6.8985
[2025-11-08 19:27:22] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.056, 0.098, 0.284, 0.323, 0.24]
[2025-11-08 19:27:22] [INFO] -          [Server] Round 15 Avg Reward (All Clients): 55.13%
[2025-11-08 19:27:22] [INFO] - 
[Main] Round 15: グローバルテスト精度を計算中...
[2025-11-08 19:27:24] [INFO] - ====== [Main] Round 15 Global Test Accuracy: 28.7100% ======
[2025-11-08 19:27:24] [INFO] - 
--- Round 16/20 ---
[2025-11-08 19:27:29] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9860
[2025-11-08 19:27:31] [INFO] -   [Client 0] Evaluate Reward: R_i = 69.90% (7737/11068)
[2025-11-08 19:27:35] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3454
[2025-11-08 19:27:36] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.22% (4302/7518)
[2025-11-08 19:27:42] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.4247
[2025-11-08 19:27:45] [INFO] -   [Client 2] Evaluate Reward: R_i = 52.86% (6813/12889)
[2025-11-08 19:27:49] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.3138
[2025-11-08 19:27:51] [INFO] -   [Client 3] Evaluate Reward: R_i = 49.64% (4797/9664)
[2025-11-08 19:27:55] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6279
[2025-11-08 19:27:57] [INFO] -   [Client 4] Evaluate Reward: R_i = 44.04% (3902/8861)
[2025-11-08 19:27:57] [INFO] -          [Server] SW-SPSA Update: R+(w)=52.62, R-(w)=50.13, GradFactor=12.4112
[2025-11-08 19:27:57] [INFO] -          [Server] (Round 16) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:30:07] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:30:07] [INFO] -          Client 0: phi = 3.2475
[2025-11-08 19:30:07] [INFO] -          Client 1: phi = 3.1740
[2025-11-08 19:30:07] [INFO] -          Client 2: phi = 8.6040
[2025-11-08 19:30:07] [INFO] -          Client 3: phi = 6.3255
[2025-11-08 19:30:07] [INFO] -          Client 4: phi = 8.8490
[2025-11-08 19:30:07] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.108, 0.105, 0.285, 0.209, 0.293]
[2025-11-08 19:30:07] [INFO] -          [Server] Round 16 Avg Reward (All Clients): 54.73%
[2025-11-08 19:30:07] [INFO] - 
[Main] Round 16: グローバルテスト精度を計算中...
[2025-11-08 19:30:09] [INFO] - ====== [Main] Round 16 Global Test Accuracy: 30.2000% ======
[2025-11-08 19:30:09] [INFO] - 
--- Round 17/20 ---
[2025-11-08 19:30:14] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0057
[2025-11-08 19:30:16] [INFO] -   [Client 0] Evaluate Reward: R_i = 69.10% (7648/11068)
[2025-11-08 19:30:20] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3880
[2025-11-08 19:30:21] [INFO] -   [Client 1] Evaluate Reward: R_i = 58.18% (4374/7518)
[2025-11-08 19:30:27] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.2286
[2025-11-08 19:30:30] [INFO] -   [Client 2] Evaluate Reward: R_i = 59.58% (7679/12889)
[2025-11-08 19:30:34] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0995
[2025-11-08 19:30:36] [INFO] -   [Client 3] Evaluate Reward: R_i = 68.48% (6618/9664)
[2025-11-08 19:30:40] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6364
[2025-11-08 19:30:42] [INFO] -   [Client 4] Evaluate Reward: R_i = 44.90% (3979/8861)
[2025-11-08 19:30:42] [INFO] -          [Server] SW-SPSA Update: R+(w)=54.73, R-(w)=61.34, GradFactor=-33.0416
[2025-11-08 19:30:42] [INFO] -          [Server] (Round 17) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:32:52] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:32:52] [INFO] -          Client 0: phi = 6.1405
[2025-11-08 19:32:52] [INFO] -          Client 1: phi = 6.2640
[2025-11-08 19:32:52] [INFO] -          Client 2: phi = 3.7765
[2025-11-08 19:32:52] [INFO] -          Client 3: phi = 8.1690
[2025-11-08 19:32:52] [INFO] -          Client 4: phi = 6.9800
[2025-11-08 19:32:52] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.196, 0.2, 0.121, 0.261, 0.223]
[2025-11-08 19:32:52] [INFO] -          [Server] Round 17 Avg Reward (All Clients): 60.05%
[2025-11-08 19:32:52] [INFO] - 
[Main] Round 17: グローバルテスト精度を計算中...
[2025-11-08 19:32:53] [INFO] - ====== [Main] Round 17 Global Test Accuracy: 31.3300% ======
[2025-11-08 19:32:53] [INFO] - 
--- Round 18/20 ---
[2025-11-08 19:32:58] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9761
[2025-11-08 19:33:00] [INFO] -   [Client 0] Evaluate Reward: R_i = 70.81% (7837/11068)
[2025-11-08 19:33:04] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3593
[2025-11-08 19:33:05] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.89% (4352/7518)
[2025-11-08 19:33:12] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.1776
[2025-11-08 19:33:14] [INFO] -   [Client 2] Evaluate Reward: R_i = 59.10% (7617/12889)
[2025-11-08 19:33:19] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0217
[2025-11-08 19:33:21] [INFO] -   [Client 3] Evaluate Reward: R_i = 70.61% (6824/9664)
[2025-11-08 19:33:25] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6545
[2025-11-08 19:33:27] [INFO] -   [Client 4] Evaluate Reward: R_i = 43.66% (3869/8861)
[2025-11-08 19:33:27] [INFO] -          [Server] SW-SPSA Update: R+(w)=64.28, R-(w)=58.38, GradFactor=29.5402
[2025-11-08 19:33:27] [INFO] -          [Server] (Round 18) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:35:38] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:35:38] [INFO] -          Client 0: phi = 2.3160
[2025-11-08 19:35:38] [INFO] -          Client 1: phi = 4.4575
[2025-11-08 19:35:38] [INFO] -          Client 2: phi = 5.2330
[2025-11-08 19:35:38] [INFO] -          Client 3: phi = 13.1555
[2025-11-08 19:35:38] [INFO] -          Client 4: phi = 4.7180
[2025-11-08 19:35:38] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.078, 0.149, 0.175, 0.44, 0.158]
[2025-11-08 19:35:38] [INFO] -          [Server] Round 18 Avg Reward (All Clients): 60.41%
[2025-11-08 19:35:38] [INFO] - 
[Main] Round 18: グローバルテスト精度を計算中...
[2025-11-08 19:35:39] [INFO] - ====== [Main] Round 18 Global Test Accuracy: 29.8800% ======
[2025-11-08 19:35:39] [INFO] - 
--- Round 19/20 ---
[2025-11-08 19:35:44] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0092
[2025-11-08 19:35:47] [INFO] -   [Client 0] Evaluate Reward: R_i = 70.98% (7856/11068)
[2025-11-08 19:35:50] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3380
[2025-11-08 19:35:52] [INFO] -   [Client 1] Evaluate Reward: R_i = 57.37% (4313/7518)
[2025-11-08 19:35:58] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.2296
[2025-11-08 19:36:00] [INFO] -   [Client 2] Evaluate Reward: R_i = 60.00% (7733/12889)
[2025-11-08 19:36:05] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0202
[2025-11-08 19:36:07] [INFO] -   [Client 3] Evaluate Reward: R_i = 70.53% (6816/9664)
[2025-11-08 19:36:11] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6592
[2025-11-08 19:36:12] [INFO] -   [Client 4] Evaluate Reward: R_i = 42.53% (3769/8861)
[2025-11-08 19:36:12] [INFO] -          [Server] SW-SPSA Update: R+(w)=51.72, R-(w)=67.64, GradFactor=-79.6036
[2025-11-08 19:36:12] [INFO] -          [Server] (Round 19) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:38:21] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:38:21] [INFO] -          Client 0: phi = 3.5850
[2025-11-08 19:38:21] [INFO] -          Client 1: phi = 6.0105
[2025-11-08 19:38:21] [INFO] -          Client 2: phi = 7.4575
[2025-11-08 19:38:21] [INFO] -          Client 3: phi = 4.8805
[2025-11-08 19:38:21] [INFO] -          Client 4: phi = 6.8465
[2025-11-08 19:38:21] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.125, 0.209, 0.259, 0.17, 0.238]
[2025-11-08 19:38:21] [INFO] -          [Server] Round 19 Avg Reward (All Clients): 60.28%
[2025-11-08 19:38:21] [INFO] - 
[Main] Round 19: グローバルテスト精度を計算中...
[2025-11-08 19:38:22] [INFO] - ====== [Main] Round 19 Global Test Accuracy: 28.7800% ======
[2025-11-08 19:38:22] [INFO] - 
--- Round 20/20 ---
[2025-11-08 19:38:27] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0175
[2025-11-08 19:38:29] [INFO] -   [Client 0] Evaluate Reward: R_i = 71.54% (7918/11068)
[2025-11-08 19:38:33] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3823
[2025-11-08 19:38:34] [INFO] -   [Client 1] Evaluate Reward: R_i = 58.54% (4401/7518)
[2025-11-08 19:38:40] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 1.3978
[2025-11-08 19:38:43] [INFO] -   [Client 2] Evaluate Reward: R_i = 44.99% (5799/12889)
[2025-11-08 19:38:47] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.0136
[2025-11-08 19:38:49] [INFO] -   [Client 3] Evaluate Reward: R_i = 70.72% (6834/9664)
[2025-11-08 19:38:53] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.6138
[2025-11-08 19:38:55] [INFO] -   [Client 4] Evaluate Reward: R_i = 44.50% (3943/8861)
[2025-11-08 19:38:55] [INFO] -          [Server] SW-SPSA Update: R+(w)=55.41, R-(w)=55.35, GradFactor=0.3082
[2025-11-08 19:38:55] [INFO] -          [Server] (Round 20) 次ラウンド用のShapley重みを計算中...
[2025-11-08 19:41:04] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-08 19:41:04] [INFO] -          Client 0: phi = 4.5175
[2025-11-08 19:41:04] [INFO] -          Client 1: phi = 1.8715
[2025-11-08 19:41:04] [INFO] -          Client 2: phi = 6.1510
[2025-11-08 19:41:04] [INFO] -          Client 3: phi = 11.8100
[2025-11-08 19:41:04] [INFO] -          Client 4: phi = 6.8000
[2025-11-08 19:41:04] [INFO] -          [Server] 次ラウンド用の重みを更新完了: [0.145, 0.06, 0.197, 0.379, 0.218]
[2025-11-08 19:41:04] [INFO] - 
[Server] Gradient-based Proxy Validation を開始...
[2025-11-08 19:41:04] [INFO] - [Proxy Validation] 各クライアントの勾配貢献度 (C_i) を計算:
[2025-11-08 19:41:04] [INFO] -          Client 0: C_i = 8.1961e-01
[2025-11-08 19:41:04] [INFO] -          Client 1: C_i = 5.8210e-01
[2025-11-08 19:41:04] [INFO] -          Client 2: C_i = 1.7817e-01
[2025-11-08 19:41:04] [INFO] -          Client 3: C_i = 1.0584e+00
[2025-11-08 19:41:04] [INFO] -          Client 4: C_i = 8.6987e-01
[2025-11-08 19:41:04] [INFO] - 
========================================
[2025-11-08 19:41:04] [INFO] - --- Gradient-based Proxy 検証結果 ---
[2025-11-08 19:41:04] [INFO] - ========================================
[2025-11-08 19:41:04] [INFO] - Client ID  | Phi (Shapley値)    | C_i (Proxyスコア)   
[2025-11-08 19:41:04] [INFO] - ------------------------------------------------
[2025-11-08 19:41:04] [INFO] - 0          | 4.5175            | 8.1961e-01       
[2025-11-08 19:41:04] [INFO] - 1          | 1.8715            | 5.8210e-01       
[2025-11-08 19:41:04] [INFO] - 2          | 6.1510            | 1.7817e-01       
[2025-11-08 19:41:04] [INFO] - 3          | 11.8100           | 1.0584e+00       
[2025-11-08 19:41:04] [INFO] - 4          | 6.8000            | 8.6987e-01       
[2025-11-08 19:41:04] [INFO] - ------------------------------------------------
[2025-11-08 19:41:04] [INFO] - 
[相関分析結果]
[2025-11-08 19:41:04] [INFO] - スピアマン相関係数 (rho) : 0.7000 (p-value: 0.1881)
[2025-11-08 19:41:04] [INFO] - 
[結論] 正の相関が見られますが、基準 (rho > 0.8) には達していません。
[2025-11-08 19:41:04] [INFO] -          [Server] Round 20 Avg Reward (All Clients): 58.06%
[2025-11-08 19:41:04] [INFO] - 
[Main] Round 20: グローバルテスト精度を計算中...
[2025-11-08 19:41:06] [INFO] - ====== [Main] Round 20 Global Test Accuracy: 31.1500% ======
[2025-11-08 19:41:06] [INFO] - ------------------------------
[2025-11-08 19:41:06] [INFO] - --- [パート1] 学習完了 --- (総所要時間: 3279.49 秒)
[2025-11-08 19:41:06] [INFO] - 
[Main] すべての処理が完了しました。
