[2025-11-09 13:00:34] [INFO] - [Main] /home/miyata/LoRA_Kuroki/DualB-FedLoRA/resnet/../config.yml から設定をロードしました。
[2025-11-09 13:00:34] [INFO] - Loaded config:
{
  "experiment_name": "02",
  "num_clients": 5,
  "num_rounds": 20,
  "local_epochs": 2,
  "non_iid_alpha": 0.3,
  "eval_interval": 1,
  "rank": 4,
  "image_size": 64,
  "lora_target_modules": [
    "mlp",
    "head"
  ],
  "client_lr": 0.01,
  "server_lr": 0.1,
  "spsa_eta_b": 0.0001,
  "spsa_epsilon": 0.1,
  "server_momentum": 0.9,
  "shapley_tmc_iterations": 20,
  "proxy_validation_type": "g_A"
}
[2025-11-09 13:00:34] [INFO] - 
[Main] Using device: cuda
[2025-11-09 13:00:34] [INFO] - 
[Main] 共通データセットを準備します...
[2025-11-09 13:00:34] [INFO] - [Main] 入力解像度を 64x64 に設定します。
[2025-11-09 13:00:35] [INFO] - [Data] Non-IIDデータ分割を開始 (Alpha=0.3)...
[2025-11-09 13:00:35] [INFO] - [Data] 5 クライアント分のデータローダーを作成完了。
[2025-11-09 13:00:35] [INFO] - [Main] テストローダーのバッチサイズ: 64
[2025-11-09 13:00:35] [INFO] - --- [パート1] B-Fixed (ResNet) 版 ---
[2025-11-09 13:00:35] [INFO] - Clients: 5, Rounds: 20, Rank: 4
[2025-11-09 13:00:35] [INFO] - ------------------------------
[2025-11-09 13:00:35] [INFO] - [Model] ResNet-50 (ImageNet-1k) をロード中...
[2025-11-09 13:00:35] [INFO] - [Model] ResNet-50ロード完了。分類ヘッド (Linear 2048->10) をLoRA化 (Rank=4)。
[2025-11-09 13:00:35] [INFO] - [Server] B_server を直交行列 (shape 10x4) で初期化しました。
[2025-11-09 13:00:35] [INFO] - [Server] B-Fixed (ResNet) サーバを初期化しました。
[2025-11-09 13:00:35] [INFO] - [Main] Client LR: 0.01
[2025-11-09 13:00:36] [INFO] - [Main] 5 クライアントの初期化完了。
[2025-11-09 13:00:36] [INFO] - ------------------------------
[2025-11-09 13:00:36] [INFO] - [Main] グローバルテスト精度を 1 ラウンドごとに計算します。
[2025-11-09 13:00:36] [INFO] - 
--- Round 1/20 ---
[2025-11-09 13:00:48] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.6249
[2025-11-09 13:01:10] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.3503
[2025-11-09 13:01:21] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.8948
[2025-11-09 13:01:30] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 1.1259
[2025-11-09 13:01:47] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.3648
[2025-11-09 13:01:47] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:01:47] [INFO] - 
[Main] Round 1: グローバルテスト精度を計算中...
[2025-11-09 13:01:50] [INFO] - ====== [Main] Round 1 Global Test Accuracy: 38.9200% ======
[2025-11-09 13:01:50] [INFO] - 
--- Round 2/20 ---
[2025-11-09 13:01:57] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.3579
[2025-11-09 13:02:20] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.1062
[2025-11-09 13:02:30] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.6017
[2025-11-09 13:02:39] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.8753
[2025-11-09 13:02:54] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.2105
[2025-11-09 13:02:54] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:02:54] [INFO] - 
[Main] Round 2: グローバルテスト精度を計算中...
[2025-11-09 13:02:57] [INFO] - ====== [Main] Round 2 Global Test Accuracy: 41.9800% ======
[2025-11-09 13:02:57] [INFO] - 
--- Round 3/20 ---
[2025-11-09 13:03:05] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.2488
[2025-11-09 13:03:26] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 1.0292
[2025-11-09 13:03:37] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.5357
[2025-11-09 13:03:46] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.8390
[2025-11-09 13:04:02] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1735
[2025-11-09 13:04:02] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:04:02] [INFO] - 
[Main] Round 3: グローバルテスト精度を計算中...
[2025-11-09 13:04:04] [INFO] - ====== [Main] Round 3 Global Test Accuracy: 42.6500% ======
[2025-11-09 13:04:04] [INFO] - 
--- Round 4/20 ---
[2025-11-09 13:04:14] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1982
[2025-11-09 13:04:38] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.9937
[2025-11-09 13:04:51] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4987
[2025-11-09 13:05:00] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.8030
[2025-11-09 13:05:18] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1523
[2025-11-09 13:05:18] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:05:18] [INFO] - 
[Main] Round 4: グローバルテスト精度を計算中...
[2025-11-09 13:05:21] [INFO] - ====== [Main] Round 4 Global Test Accuracy: 43.5100% ======
[2025-11-09 13:05:21] [INFO] - 
--- Round 5/20 ---
[2025-11-09 13:05:31] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1513
[2025-11-09 13:05:57] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.9598
[2025-11-09 13:06:09] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4820
[2025-11-09 13:06:19] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7828
[2025-11-09 13:06:38] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1333
[2025-11-09 13:06:38] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:06:38] [INFO] - 
[Main] Round 5: グローバルテスト精度を計算中...
[2025-11-09 13:06:41] [INFO] - ====== [Main] Round 5 Global Test Accuracy: 44.1000% ======
[2025-11-09 13:06:41] [INFO] - 
--- Round 6/20 ---
[2025-11-09 13:06:51] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1259
[2025-11-09 13:07:15] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.9390
[2025-11-09 13:07:27] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4628
[2025-11-09 13:07:37] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7676
[2025-11-09 13:07:55] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1193
[2025-11-09 13:07:55] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:07:55] [INFO] - 
[Main] Round 6: グローバルテスト精度を計算中...
[2025-11-09 13:07:58] [INFO] - ====== [Main] Round 6 Global Test Accuracy: 44.6000% ======
[2025-11-09 13:07:58] [INFO] - 
--- Round 7/20 ---
[2025-11-09 13:08:07] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.1152
[2025-11-09 13:08:31] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.9264
[2025-11-09 13:08:44] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4444
[2025-11-09 13:08:54] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7535
[2025-11-09 13:09:14] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1134
[2025-11-09 13:09:14] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:09:14] [INFO] - 
[Main] Round 7: グローバルテスト精度を計算中...
[2025-11-09 13:09:17] [INFO] - ====== [Main] Round 7 Global Test Accuracy: 45.0700% ======
[2025-11-09 13:09:17] [INFO] - 
--- Round 8/20 ---
[2025-11-09 13:09:26] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0825
[2025-11-09 13:09:54] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.9074
[2025-11-09 13:10:08] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4386
[2025-11-09 13:10:20] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7483
[2025-11-09 13:10:39] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.1067
[2025-11-09 13:10:39] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:10:39] [INFO] - 
[Main] Round 8: グローバルテスト精度を計算中...
[2025-11-09 13:10:41] [INFO] - ====== [Main] Round 8 Global Test Accuracy: 45.3900% ======
[2025-11-09 13:10:41] [INFO] - 
--- Round 9/20 ---
[2025-11-09 13:10:50] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0697
[2025-11-09 13:11:11] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8922
[2025-11-09 13:11:22] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4272
[2025-11-09 13:11:30] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7328
[2025-11-09 13:11:46] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0935
[2025-11-09 13:11:46] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:11:46] [INFO] - 
[Main] Round 9: グローバルテスト精度を計算中...
[2025-11-09 13:11:49] [INFO] - ====== [Main] Round 9 Global Test Accuracy: 45.6400% ======
[2025-11-09 13:11:49] [INFO] - 
--- Round 10/20 ---
[2025-11-09 13:11:57] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0511
[2025-11-09 13:12:18] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8779
[2025-11-09 13:12:29] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4188
[2025-11-09 13:12:37] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7339
[2025-11-09 13:12:53] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0929
[2025-11-09 13:12:53] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:12:53] [INFO] - 
[Main] Round 10: グローバルテスト精度を計算中...
[2025-11-09 13:12:56] [INFO] - ====== [Main] Round 10 Global Test Accuracy: 46.0700% ======
[2025-11-09 13:12:56] [INFO] - 
--- Round 11/20 ---
[2025-11-09 13:13:06] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0465
[2025-11-09 13:13:31] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8766
[2025-11-09 13:13:44] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4135
[2025-11-09 13:13:53] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7202
[2025-11-09 13:14:12] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0863
[2025-11-09 13:14:12] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:14:12] [INFO] - 
[Main] Round 11: グローバルテスト精度を計算中...
[2025-11-09 13:14:16] [INFO] - ====== [Main] Round 11 Global Test Accuracy: 46.5200% ======
[2025-11-09 13:14:16] [INFO] - 
--- Round 12/20 ---
[2025-11-09 13:14:30] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0326
[2025-11-09 13:15:04] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8661
[2025-11-09 13:15:21] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.4080
[2025-11-09 13:15:35] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7211
[2025-11-09 13:16:00] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0781
[2025-11-09 13:16:00] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:16:00] [INFO] - 
[Main] Round 12: グローバルテスト精度を計算中...
[2025-11-09 13:16:04] [INFO] - ====== [Main] Round 12 Global Test Accuracy: 46.6700% ======
[2025-11-09 13:16:04] [INFO] - 
--- Round 13/20 ---
[2025-11-09 13:16:15] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0177
[2025-11-09 13:16:44] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8618
[2025-11-09 13:16:59] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3997
[2025-11-09 13:17:11] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7115
[2025-11-09 13:17:33] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0796
[2025-11-09 13:17:33] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:17:33] [INFO] - 
[Main] Round 13: グローバルテスト精度を計算中...
[2025-11-09 13:17:36] [INFO] - ====== [Main] Round 13 Global Test Accuracy: 47.1200% ======
[2025-11-09 13:17:36] [INFO] - 
--- Round 14/20 ---
[2025-11-09 13:17:47] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0128
[2025-11-09 13:18:17] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8571
[2025-11-09 13:18:32] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3967
[2025-11-09 13:18:44] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7074
[2025-11-09 13:19:06] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0768
[2025-11-09 13:19:06] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:19:06] [INFO] - 
[Main] Round 14: グローバルテスト精度を計算中...
[2025-11-09 13:19:09] [INFO] - ====== [Main] Round 14 Global Test Accuracy: 47.0200% ======
[2025-11-09 13:19:09] [INFO] - 
--- Round 15/20 ---
[2025-11-09 13:19:17] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 1.0013
[2025-11-09 13:19:39] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8564
[2025-11-09 13:19:50] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3878
[2025-11-09 13:19:57] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7105
[2025-11-09 13:20:14] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0726
[2025-11-09 13:20:14] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:20:14] [INFO] - 
[Main] Round 15: グローバルテスト精度を計算中...
[2025-11-09 13:20:17] [INFO] - ====== [Main] Round 15 Global Test Accuracy: 47.1800% ======
[2025-11-09 13:20:17] [INFO] - 
--- Round 16/20 ---
[2025-11-09 13:20:27] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9964
[2025-11-09 13:20:56] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8455
[2025-11-09 13:21:11] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3916
[2025-11-09 13:21:23] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.7052
[2025-11-09 13:21:44] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0761
[2025-11-09 13:21:44] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:21:44] [INFO] - 
[Main] Round 16: グローバルテスト精度を計算中...
[2025-11-09 13:21:47] [INFO] - ====== [Main] Round 16 Global Test Accuracy: 47.2600% ======
[2025-11-09 13:21:47] [INFO] - 
--- Round 17/20 ---
[2025-11-09 13:21:59] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9894
[2025-11-09 13:22:29] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8405
[2025-11-09 13:22:43] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3828
[2025-11-09 13:22:54] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.6947
[2025-11-09 13:23:16] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0666
[2025-11-09 13:23:16] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:23:16] [INFO] - 
[Main] Round 17: グローバルテスト精度を計算中...
[2025-11-09 13:23:19] [INFO] - ====== [Main] Round 17 Global Test Accuracy: 47.1200% ======
[2025-11-09 13:23:19] [INFO] - 
--- Round 18/20 ---
[2025-11-09 13:23:27] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9721
[2025-11-09 13:23:48] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8382
[2025-11-09 13:23:59] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3762
[2025-11-09 13:24:07] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.6890
[2025-11-09 13:24:23] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0638
[2025-11-09 13:24:23] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:24:23] [INFO] - 
[Main] Round 18: グローバルテスト精度を計算中...
[2025-11-09 13:24:25] [INFO] - ====== [Main] Round 18 Global Test Accuracy: 47.2900% ======
[2025-11-09 13:24:25] [INFO] - 
--- Round 19/20 ---
[2025-11-09 13:24:34] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9811
[2025-11-09 13:24:55] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8364
[2025-11-09 13:25:06] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3818
[2025-11-09 13:25:14] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.6890
[2025-11-09 13:25:30] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0668
[2025-11-09 13:25:30] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:25:30] [INFO] - 
[Main] Round 19: グローバルテスト精度を計算中...
[2025-11-09 13:25:33] [INFO] - ====== [Main] Round 19 Global Test Accuracy: 47.6000% ======
[2025-11-09 13:25:33] [INFO] - 
--- Round 20/20 ---
[2025-11-09 13:25:41] [INFO] -   [Client 0] Local Train (A only): Avg Loss = 0.9779
[2025-11-09 13:26:03] [INFO] -   [Client 1] Local Train (A only): Avg Loss = 0.8321
[2025-11-09 13:26:13] [INFO] -   [Client 2] Local Train (A only): Avg Loss = 0.3660
[2025-11-09 13:26:21] [INFO] -   [Client 3] Local Train (A only): Avg Loss = 0.6955
[2025-11-09 13:26:37] [INFO] -   [Client 4] Local Train (A only): Avg Loss = 1.0591
[2025-11-09 13:26:37] [INFO] -          [Server] B_server は固定されているため、更新をスキップします。
[2025-11-09 13:26:37] [INFO] - 
[Server] Shapley値 (TMC) の計算を開始...
[2025-11-09 13:26:37] [INFO] -            [Shapley] TMC-Shapley (T=20) 開始...
[2025-11-09 13:26:40] [INFO] -            [Shapley] V(S=[0]) = 47.2300%
[2025-11-09 13:26:42] [INFO] -            [Shapley] V(S=[0, 3]) = 48.3500%
[2025-11-09 13:26:44] [INFO] -            [Shapley] V(S=[0, 2, 3]) = 40.0800%
[2025-11-09 13:26:46] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 47.0900%
[2025-11-09 13:26:49] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:26:51] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:26:54] [INFO] -            [Shapley] V(S=[0, 1]) = 55.6700%
[2025-11-09 13:26:56] [INFO] -            [Shapley] V(S=[0, 1, 4]) = 56.8800%
[2025-11-09 13:26:59] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 41.4900%
[2025-11-09 13:27:01] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:27:04] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:27:06] [INFO] -            [Shapley] V(S=[1, 3]) = 51.1300%
[2025-11-09 13:27:08] [INFO] -            [Shapley] V(S=[1, 3, 4]) = 55.0900%
[2025-11-09 13:27:11] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 43.9500%
[2025-11-09 13:27:13] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:27:16] [INFO] -            [Shapley] V(S=[2]) = 24.1400%
[2025-11-09 13:27:18] [INFO] -            [Shapley] V(S=[2, 4]) = 20.1800%
[2025-11-09 13:27:20] [INFO] -            [Shapley] V(S=[0, 2, 4]) = 31.7100%
[2025-11-09 13:27:23] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 40.7800%
[2025-11-09 13:27:25] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:27:28] [INFO] -            [Shapley] V(S=[2]) = 24.1400%
[2025-11-09 13:27:30] [INFO] -            [Shapley] V(S=[2, 3]) = 33.3900%
[2025-11-09 13:27:33] [INFO] -            [Shapley] V(S=[0, 2, 3]) = 40.0800%
[2025-11-09 13:27:35] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 40.7800%
[2025-11-09 13:27:37] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:27:40] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:27:42] [INFO] -            [Shapley] V(S=[0, 1]) = 55.6700%
[2025-11-09 13:27:45] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 56.9900%
[2025-11-09 13:27:47] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 57.7000%
[2025-11-09 13:27:49] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:27:51] [INFO] -            [Shapley] V(S=[2]) = 24.1400%
[2025-11-09 13:27:54] [INFO] -            [Shapley] V(S=[1, 2]) = 37.6700%
[2025-11-09 13:27:56] [INFO] -            [Shapley] V(S=[1, 2, 4]) = 36.1900%
[2025-11-09 13:27:59] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 41.4900%
[2025-11-09 13:28:01] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:28:04] [INFO] -            [Shapley] V(S=[0]) = 47.2300%
[2025-11-09 13:28:06] [INFO] -            [Shapley] V(S=[0, 1]) = 55.6700%
[2025-11-09 13:28:08] [INFO] -            [Shapley] V(S=[0, 1, 2]) = 42.7000%
[2025-11-09 13:28:11] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 41.4900%
[2025-11-09 13:28:13] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:28:16] [INFO] -            [Shapley] V(S=[0]) = 47.2300%
[2025-11-09 13:28:19] [INFO] -            [Shapley] V(S=[0, 1]) = 55.6700%
[2025-11-09 13:28:21] [INFO] -            [Shapley] V(S=[0, 1, 3]) = 56.9900%
[2025-11-09 13:28:23] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 57.7000%
[2025-11-09 13:28:26] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:28:28] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:28:31] [INFO] -            [Shapley] V(S=[0, 1]) = 55.6700%
[2025-11-09 13:28:33] [INFO] -            [Shapley] V(S=[0, 1, 2]) = 42.7000%
[2025-11-09 13:28:35] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 47.0900%
[2025-11-09 13:28:38] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:28:40] [INFO] -            [Shapley] V(S=[3]) = 27.8000%
[2025-11-09 13:28:43] [INFO] -            [Shapley] V(S=[0, 3]) = 48.3500%
[2025-11-09 13:28:45] [INFO] -            [Shapley] V(S=[0, 3, 4]) = 49.6800%
[2025-11-09 13:28:48] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 40.7800%
[2025-11-09 13:28:50] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:28:52] [INFO] -            [Shapley] V(S=[3]) = 27.8000%
[2025-11-09 13:28:54] [INFO] -            [Shapley] V(S=[3, 4]) = 43.3500%
[2025-11-09 13:28:57] [INFO] -            [Shapley] V(S=[0, 3, 4]) = 49.6800%
[2025-11-09 13:28:59] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 57.7000%
[2025-11-09 13:29:02] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:29:04] [INFO] -            [Shapley] V(S=[2]) = 24.1400%
[2025-11-09 13:29:07] [INFO] -            [Shapley] V(S=[0, 2]) = 31.9900%
[2025-11-09 13:29:10] [INFO] -            [Shapley] V(S=[0, 1, 2]) = 42.7000%
[2025-11-09 13:29:12] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 41.4900%
[2025-11-09 13:29:15] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:29:17] [INFO] -            [Shapley] V(S=[4]) = 37.5200%
[2025-11-09 13:29:20] [INFO] -            [Shapley] V(S=[2, 4]) = 20.1800%
[2025-11-09 13:29:22] [INFO] -            [Shapley] V(S=[0, 2, 4]) = 31.7100%
[2025-11-09 13:29:24] [INFO] -            [Shapley] V(S=[0, 2, 3, 4]) = 40.7800%
[2025-11-09 13:29:27] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:29:29] [INFO] -            [Shapley] V(S=[2]) = 24.1400%
[2025-11-09 13:29:32] [INFO] -            [Shapley] V(S=[1, 2]) = 37.6700%
[2025-11-09 13:29:34] [INFO] -            [Shapley] V(S=[1, 2, 4]) = 36.1900%
[2025-11-09 13:29:36] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 43.9500%
[2025-11-09 13:29:39] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:29:41] [INFO] -            [Shapley] V(S=[3]) = 27.8000%
[2025-11-09 13:29:44] [INFO] -            [Shapley] V(S=[2, 3]) = 33.3900%
[2025-11-09 13:29:46] [INFO] -            [Shapley] V(S=[1, 2, 3]) = 43.6600%
[2025-11-09 13:29:49] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 47.0900%
[2025-11-09 13:29:51] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:29:54] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:29:56] [INFO] -            [Shapley] V(S=[1, 3]) = 51.1300%
[2025-11-09 13:29:59] [INFO] -            [Shapley] V(S=[1, 2, 3]) = 43.6600%
[2025-11-09 13:30:01] [INFO] -            [Shapley] V(S=[1, 2, 3, 4]) = 43.9500%
[2025-11-09 13:30:04] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:30:06] [INFO] -            [Shapley] V(S=[1]) = 52.9600%
[2025-11-09 13:30:09] [INFO] -            [Shapley] V(S=[1, 3]) = 51.1300%
[2025-11-09 13:30:11] [INFO] -            [Shapley] V(S=[1, 3, 4]) = 55.0900%
[2025-11-09 13:30:14] [INFO] -            [Shapley] V(S=[0, 1, 3, 4]) = 57.7000%
[2025-11-09 13:30:16] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:30:19] [INFO] -            [Shapley] V(S=[0]) = 47.2300%
[2025-11-09 13:30:21] [INFO] -            [Shapley] V(S=[0, 3]) = 48.3500%
[2025-11-09 13:30:24] [INFO] -            [Shapley] V(S=[0, 2, 3]) = 40.0800%
[2025-11-09 13:30:26] [INFO] -            [Shapley] V(S=[0, 1, 2, 3]) = 47.0900%
[2025-11-09 13:30:28] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:30:30] [INFO] -            [Shapley] V(S=[4]) = 37.5200%
[2025-11-09 13:30:33] [INFO] -            [Shapley] V(S=[0, 4]) = 45.6100%
[2025-11-09 13:30:35] [INFO] -            [Shapley] V(S=[0, 1, 4]) = 56.8800%
[2025-11-09 13:30:38] [INFO] -            [Shapley] V(S=[0, 1, 2, 4]) = 41.4900%
[2025-11-09 13:30:40] [INFO] -            [Shapley] V(S=[0, 1, 2, 3, 4]) = 47.4000%
[2025-11-09 13:30:40] [INFO] - [Server] Shapley Values (TMC) 算出完了:
[2025-11-09 13:30:40] [INFO] -          Client 0: phi = 14.5655
[2025-11-09 13:30:40] [INFO] -          Client 1: phi = 22.1235
[2025-11-09 13:30:40] [INFO] -          Client 2: phi = -1.6510
[2025-11-09 13:30:40] [INFO] -          Client 3: phi = 7.5940
[2025-11-09 13:30:40] [INFO] -          Client 4: phi = 4.7680
[2025-11-09 13:30:40] [INFO] - 
[Server] (検証1) Gradient-based Proxy Validation を開始...
[2025-11-09 13:30:40] [INFO] - [Proxy Validation] 各クライアントの勾配貢献度 (C_i) を計算:
[2025-11-09 13:30:40] [INFO] -          Client 0: C_i = 5.4042e-01
[2025-11-09 13:30:40] [INFO] -          Client 1: C_i = 1.0011e+00
[2025-11-09 13:30:40] [INFO] -          Client 2: C_i = 1.2366e+00
[2025-11-09 13:30:40] [INFO] -          Client 3: C_i = 1.5759e-01
[2025-11-09 13:30:40] [INFO] -          Client 4: C_i = 6.6369e-01
[2025-11-09 13:30:40] [INFO] - 
========================================
[2025-11-09 13:30:40] [INFO] - --- (検証1) Gradient-based Proxy 検証結果 ---
[2025-11-09 13:30:40] [INFO] - ========================================
[2025-11-09 13:30:40] [INFO] - Client ID  | Phi (Shapley値)    | C_i (Proxyスコア)   
[2025-11-09 13:30:40] [INFO] - ------------------------------------------------
[2025-11-09 13:30:40] [INFO] - 0          | 14.5655           | 5.4042e-01       
[2025-11-09 13:30:40] [INFO] - 1          | 22.1235           | 1.0011e+00       
[2025-11-09 13:30:40] [INFO] - 2          | -1.6510           | 1.2366e+00       
[2025-11-09 13:30:40] [INFO] - 3          | 7.5940            | 1.5759e-01       
[2025-11-09 13:30:40] [INFO] - 4          | 4.7680            | 6.6369e-01       
[2025-11-09 13:30:40] [INFO] - ------------------------------------------------
[2025-11-09 13:30:40] [INFO] - 
[相関分析結果 (Proxy vs Phi)]
[2025-11-09 13:30:40] [INFO] - スピアマン相関係数 (rho) : -0.3000 (p-value: 0.6238)
[2025-11-09 13:30:40] [INFO] - 
[結論] 相関が低いか負です。
[2025-11-09 13:30:40] [INFO] - 
[Server] (検証2) Local Accuracy vs Shapley Validation を開始...
[2025-11-09 13:30:40] [INFO] - [LocalAcc Validation] 各クライアントの個別テスト精度 (Local Acc) を計算:
[2025-11-09 13:30:44] [INFO] -            [LocalAcc Eval] Client 0 (A_i only) Test Acc = 47.2300%
[2025-11-09 13:30:47] [INFO] -            [LocalAcc Eval] Client 1 (A_i only) Test Acc = 52.9600%
[2025-11-09 13:30:51] [INFO] -            [LocalAcc Eval] Client 2 (A_i only) Test Acc = 24.1400%
[2025-11-09 13:30:55] [INFO] -            [LocalAcc Eval] Client 3 (A_i only) Test Acc = 27.8000%
[2025-11-09 13:30:58] [INFO] -            [LocalAcc Eval] Client 4 (A_i only) Test Acc = 37.5200%
[2025-11-09 13:30:58] [INFO] - 
========================================
[2025-11-09 13:30:58] [INFO] - --- (検証2) Local Accuracy vs Shapley 検証結果 ---
[2025-11-09 13:30:58] [INFO] - ========================================
[2025-11-09 13:30:58] [INFO] - Client ID  | Phi (Shapley値)    | Local Acc (個別精度) 
[2025-11-09 13:30:58] [INFO] - --------------------------------------------------
[2025-11-09 13:30:58] [INFO] - 0          | 14.5655           | 47.2300          %
[2025-11-09 13:30:58] [INFO] - 1          | 22.1235           | 52.9600          %
[2025-11-09 13:30:58] [INFO] - 2          | -1.6510           | 24.1400          %
[2025-11-09 13:30:58] [INFO] - 3          | 7.5940            | 27.8000          %
[2025-11-09 13:30:58] [INFO] - 4          | 4.7680            | 37.5200          %
[2025-11-09 13:30:58] [INFO] - --------------------------------------------------
[2025-11-09 13:30:58] [INFO] - 
[相関分析結果 (Local Acc vs Phi)]
[2025-11-09 13:30:58] [INFO] - スピアマン相関係数 (rho) : 0.9000 (p-value: 0.0374)
[2025-11-09 13:30:58] [INFO] - 
[結論] 強い正の相関。Shapley値は個別のA_iの性能をよく反映しています。
[2025-11-09 13:30:58] [INFO] - 
[Main] Round 20: グローバルテスト精度を計算中...
[2025-11-09 13:31:01] [INFO] - ====== [Main] Round 20 Global Test Accuracy: 47.4000% ======
[2025-11-09 13:31:01] [INFO] - ------------------------------
[2025-11-09 13:31:01] [INFO] - --- [パート1] 学習完了 --- (総所要時間: 1825.58 秒)
[2025-11-09 13:31:01] [INFO] - 
[Main] すべての処理が完了しました。
